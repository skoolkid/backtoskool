<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Back to Skool: Bugs</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../microsphere.css" />
<link rel="stylesheet" type="text/css" href="../skool.css" />
<link rel="stylesheet" type="text/css" href="../bts.css" />

</head>
<body class="Bugs">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Bugs</td>
</tr>
</table>
<ul class="contents">
<li><a class="link" href="#fire">Catapult animation</a></li>
<li><a class="link" href="#kiss">Gate kiss</a></li>
<li><a class="link" href="#plant">Wrong plant pot</a></li>
<li><a class="link" href="#rematerialisingMouse">Rematerialising mouse</a></li>
<li><a class="link" href="#assemblyDuty">Beyond the call of assembly duty</a></li>
<li><a class="link" href="#assemblySit">Assembly sitting confusion</a></li>
<li><a class="link" href="#assemblySit2">More assembly sitting confusion</a></li>
<li><a class="link" href="#albertBusy">Keeping ALBERT busy</a></li>
<li><a class="link" href="#wackerBusy">Keeping MR WACKER busy</a></li>
<li><a class="link" href="#waitingForEinstein">Waiting for EINSTEIN</a></li>
<li><a class="link" href="#seat">Undethronable ERIC</a></li>
<li><a class="link" href="#whatsInTheDesk">What's in the desk?</a></li>
<li><a class="link" href="#farLeft">Far left scrolling</a></li>
<li><a class="link" href="#talkGarbage">Talking garbage</a></li>
<li><a class="link" href="#pelletHover">Hovering pellet</a></li>
<li><a class="link" href="#pelletWall">Pellet through the wall</a></li>
<li><a class="link" href="#pelletDoor">Pellet through the door</a></li>
<li><a class="link" href="#conkerMD">Conker of mass destruction</a></li>
<li><a class="link" href="#noBlackboardTales">No blackboard tales</a></li>
<li><a class="link" href="#doubleWipe">Double wipe</a></li>
<li><a class="link" href="#tripleWipe">Triple wipe</a></li>
<li><a class="link" href="#deceptiveDoorways">Deceptive doorways</a></li>
<li><a class="link" href="#speechQueue">Speech queue hogs</a></li>
<li><a class="link" href="#jumpAbsent">Jump out of class</a></li>
<li><a class="link" href="#jumpDinner">Jump into the dinner hall</a></li>
<li><a class="link" href="#jumpAssembly">Jump into the assembly hall</a></li>
<li><a class="link" href="#jump4Spaces">One more jump bug</a></li>
</ul>
<div><a name="fire"></a></div>
<div class="box box-1">
<div class="box-title">Catapult animation</div>
<div class="paragraph">
When ERIC fires his catapult, he should go through the following sequence of animation phases:
</div>
<div class="paragraph">
<table>
<tr>
<td><img alt="Animatory state 128" src="../images/animatory_states/as128_120x2m.png" /></td>
<td><img alt="Animatory state 138" src="../images/animatory_states/as138_120x2m.png" /></td>
<td><img alt="Animatory state 139" src="../images/animatory_states/as139_120x2m.png" /></td>
<td><img alt="Animatory state 138" src="../images/animatory_states/as138_120x2m.png" /></td>
<td><img alt="Animatory state 128" src="../images/animatory_states/as128_120x2m.png" /></td>
</tr>
</table>
</div>
<div class="paragraph">
However, the fourth phase in this sequence (lowering the arm after firing) is omitted. See <a class="link" href="../asm/24296.html">24296</a>.
</div>
<div class="paragraph">
POKE 24327,215
</div>
</div>
<div><a name="kiss"></a></div>
<div class="box box-2">
<div class="box-title">Gate kiss</div>
<div class="paragraph">
When ERIC kisses HAYLEY, he moves one space forward (see <a class="link" href="../asm/24348.html">24348</a>). This allows ERIC to pass through the skool gate if he kisses HAYLEY from behind it while it's shut.
</div>
</div>
<div><a name="plant"></a></div>
<div class="box box-1">
<div class="box-title">Wrong plant pot</div>
<div class="paragraph">
If ERIC is standing on a plant pot when a fully grown plant in another pot dies, he will fall to the ground. This is because the routine at <a class="link" href="../asm/64077.html">64077</a> checks whether ERIC is standing on a plant pot when a plant dies, but doesn't check whether it's the plant pot that contains the plant.
</div>
</div>
<div><a name="rematerialisingMouse"></a></div>
<div class="box box-2">
<div class="box-title">Rematerialising mouse</div>
<div class="paragraph">
The section of code at <a class="link" href="../asm/31573.html#31607">31607</a> is responsible for bringing a new free mouse into the game when ERIC has just caught one. The apparent intention is that the new free mouse will begin life at an x-coordinate (chosen from 10, 88 and 170) that is currently off-screen, so that you won't notice it appearing out of thin air. However, the code is careless with the <span class="register">HL</span> register pair, with the result that it is possible for a new free mouse to show up at any of these x-coordinates, regardless of which portion of the play area is currently on-screen.
</div>
<div class="paragraph">
<div>POKE <a class="link" href="../asm/31573.html#31622">31623</a>,239</div>
<div>POKE <a class="link" href="../asm/31573.html#31641">31642</a>,220</div>
<div>POKE <a class="link" href="../asm/31573.html#31649">31650</a>,212</div>
</div>
</div>
<div><a name="assemblyDuty"></a></div>
<div class="box box-1">
<div class="box-title">Beyond the call of assembly duty</div>
<div class="paragraph">
MR WITHIT takes assembly duty far too seriously. That he goes looking for ERIC if said boy is absent from the assembly hall we can understand (even if we don't approve). But if assembly has finished, it seems only fair that MR WITHIT should end the chase and leave ERIC alone. No such luck, though.
</div>
<div class="paragraph">
To witness MR WITHIT's somewhat sickening sense of duty in this regard, proceed as follows. Show up for assembly, sit down, and wait until MR WACKER arrives on stage. When MR WACKER starts speaking, stand up and head for the skool door (to the right). MR WITHIT will begin the chase, as expected. However, instead of giving up when MR WACKER has finished speaking, MR WITHIT will continue to hover around ERIC until the bell rings. (MR WITHIT does at least stop giving ERIC lines at regular intervals after MR WACKER has finished speaking, though. But that just makes the hovering feel rather creepy.)
</div>
</div>
<div><a name="assemblySit"></a></div>
<div class="box box-2">
<div class="box-title">Assembly sitting confusion</div>
<div class="paragraph">
During assembly, if ERIC is standing a teacher will scream 'SIT FACING THE STAGE', but if he's sitting down facing left (away from the stage), a teacher will scream 'NOW SIT DOWN'. This is the wrong way round.
</div>
<div class="paragraph">
POKE <a class="link" href="../asm/32062.html#32205">32205</a>,32
</div>
</div>
<div><a name="assemblySit2"></a></div>
<div class="box box-1">
<div class="box-title">More assembly sitting confusion</div>
<div class="paragraph">
Usually, the kids will sit down for assembly soon after the MSB of the lesson clock reaches 10 (see <a class="link" href="../asm/61658.html">61658</a>), in good time for MR WACKER's arrival on stage - which he doesn't bother to head off for until the MSB of the lesson clock reaches 8 (see <a class="link" href="../asm/63501.html">63501</a>). However, careful examination of the routine at <a class="link" href="../asm/61658.html">61658</a> reveals that not only must the MSB of the lesson clock have reached 10, but MR WITHIT must have arrived in the assembly hall too, otherwise the kids will not sit down. In fact, they will continue to walk around aimlessly in the assembly hall while MR WACKER is delivering his detention speech. And if MR WITHIT arrives late enough, the kids will carry on walking around aimlessly in the assembly hall even after MR WACKER has left the stage (instead of heading off to some random location, as they would normally do).
</div>
<div class="paragraph">
To witness the kids' confusion about when to sit, try making MR WITHIT late for assembly by knocking him over with a catapult pellet four or five times before he reaches the assembly hall. Then go and stand just behind MR ROCKITT and MR CREAK - who should have reached the assembly hall by now - with the stage in view at the far right of the screen. With luck, you'll be able to keep MR WITHIT out of the assembly hall with a few more well-aimed catapult pellets while watching (a) the kids wander around aimlessly instead of sitting down, and (b) MR WACKER deliver his detention speech and then leave, apparently unfazed by the lack of attention.
</div>
</div>
<div><a name="albertBusy"></a></div>
<div class="box box-2">
<div class="box-title">Keeping ALBERT busy</div>
<div class="paragraph">
After closing the skool door, ALBERT paces up and down underneath the tree while keeping an eye out for ERIC. If ERIC jumps out of the window and makes a beeline for the girls' skool, ALBERT will raise his arm, thus blocking the path to MISS TAKE's sherry. Now this behaviour makes sense during lessons, but not during playtime. However, if ERIC stands his ground after being caught by ALBERT, the caretaker will never budge. Even after the lesson ends and the bell rings for playtime. Which means it will be up to one of the teachers to open the skool door (if MR WACKER hasn't done so already after being alerted) and the skool gate.
</div>
<div class="paragraph">
If you want to check this for yourself but can't bear to wait for playtime to come, try the POKEs that enable ERIC to <a class="link" href="pokes.html#ringBell">ring the bell</a>.
</div>
</div>
<div><a name="wackerBusy"></a></div>
<div class="box box-1">
<div class="box-title">Keeping MR WACKER busy</div>
<div class="paragraph">
After closing the skool door, ALBERT paces up and down underneath the tree while keeping an eye out for ERIC. If ERIC jumps out of the window and makes a beeline for the girls' skool, ALBERT will raise the alarm, whereupon MR WACKER will come rushing to ERIC's side to make sure the truant gets back to skool and stays there. Now this behaviour makes sense during lessons, but not during playtime. However, if ERIC jumps out of the window during a lesson, stands patiently up against the skool door so as not to catch ALBERT's attention, and then rushes towards him just after the bell rings for playtime, ALBERT will raise his arm and the alarm. Which means MR WACKER will come looking for ERIC and shadow him until playtime is over.
</div>
<div class="paragraph">
If you want to check this for yourself but can't bear to wait for playtime to come, try the POKEs that enable ERIC to <a class="link" href="pokes.html#ringBell">ring the bell</a>.
</div>
</div>
<div><a name="waitingForEinstein"></a></div>
<div class="box box-2">
<div class="box-title">Waiting for EINSTEIN</div>
<div class="paragraph">
Before wiping the board and getting a lesson under way, ERIC's teacher will wait for EINSTEIN to sit down first: see <a class="link" href="../asm/61512.html">61512</a>. This makes sense at the beginning of a lesson, but that same routine is called several times during the course of a lesson (see <a class="link" href="../asm/61696.html">61696</a>) to check whether ERIC is present, which means that the teacher will also stop whatever he's doing and wait for EINSTEIN to sit down before continuing on those occasions too. This is not really noticeable except during lessons where there is no question-and-answer session taking place between the teacher and the swot, and the teacher is pacing up and down in front of the blackboard instead. During those lessons, the call to <a class="link" href="../asm/61512.html">61512</a> is made each time the teacher has reached the point where he is just about to turn round; if EINSTEIN is not sitting in a chair at that time (because ERIC has pushed him out of his seat, for example), the teacher will wait until EINSTEIN is back in his seat before turning round.
</div>
<div class="paragraph">
This phenomenon can be made more readily reproducible and observable by using the following POKEs:
</div>
<div class="paragraph">
<div>POKE <a class="link" href="../asm/26224.html#26226">26227</a>,20 (to lengthen the delay before a dethroned character rises)</div>
<div>POKE <a class="link" href="../asm/61696.html#61944">61945</a>,0 (to make every lesson a non-question-and-answer lesson)</div>
</div>
</div>
<div><a name="seat"></a></div>
<div class="box box-1">
<div class="box-title">Undethronable ERIC</div>
<div class="paragraph">
ERIC doesn't get pushed to the floor when someone sits in his seat (see <a class="link" href="../asm/26175.html">26175</a>).
</div>
<div class="paragraph">
<div>POKE 26211,54</div>
<div>POKE 26212,128</div>
</div>
</div>
<div><a name="whatsInTheDesk"></a></div>
<div class="box box-2">
<div class="box-title">What's in the desk?</div>
<div class="paragraph">
The desk lid animatory state that is used when ERIC finds the water pistol makes it look as if the desk contains stinkbombs:
</div>
<div class="paragraph">
<table>
<tr>
<td><img alt="Animatory state 45" src="../images/animatory_states/as045_120x2m.png" /></td>
</tr>
</table>
</div>
<div class="paragraph">
And the desk lid animatory state that is used when ERIC finds the stinkbombs (shown below on the left) makes it look as if the desk contains a mouse (shown on the right):
</div>
<div class="paragraph">
<table>
<tr>
<td><img alt="Animatory state 46" src="../images/animatory_states/as046_120x2m.png" /></td>
<td><img alt="Animatory state 175" src="../images/animatory_states/as175_120x2m.png" /></td>
</tr>
</table>
</div>
<div class="paragraph">
At the very least, these desk lid animatory states should be used the other way round. Since the relevant section of code at <a class="link" href="../asm/62178.html#62259">62259</a> is not amenable to POKEing to fix this, we need to swap the tile references for the desk lid animatory states themselves:
</div>
<div class="paragraph">
<div>POKE 56749,83</div>
<div>POKE 56750,84</div>
</div>
</div>
<div><a name="farLeft"></a></div>
<div class="box box-1">
<div class="box-title">Far left scrolling</div>
<div class="paragraph">
If ERIC is at the far left of the boys' skool (x-coordinate 0) facing right, and 'C', 'D', 'G', 'K', 'T' or 'U' is pressed, the screen scrolls left, pushing ERIC out of view; the screen then scrolls left again with every step ERIC takes (see <a class="link" href="../asm/28160.html">28160</a>).
</div>
<div class="paragraph">
<div>POKE 28193,198</div>
<div>POKE 28194,21</div>
<div>POKE 28195,240</div>
</div>
</div>
<div><a name="talkGarbage"></a></div>
<div class="box box-2">
<div class="box-title">Talking garbage</div>
<div class="paragraph">
If one character is speaking while a second is waiting to speak, and the screen scrolls so that the speaking character is shifted out of view, the second character may start talking garbage. What happens is that the character who was speaking first is tricked into thinking that his speech bubble is still on-screen, and the two characters end up sharing the bubble opened by the second character.
</div>
<div class="paragraph">
To see how the first character is tricked, consider the case where MR CREAK is at the Blue Room door, telling the kids to sit down, and MR WITHIT is at the Yellow Room door, waiting for MR CREAK to finish speaking:
</div>
<div class="paragraph">
<div>0) MR CREAK is under control of the entry point at <a class="link" href="../asm/27144.html#27182">27182</a> (speaking); MR WITHIT is under control of the entry point at <a class="link" href="../asm/27144.html#27165">27165</a> (waiting to speak).</div>
<div>1) The screen scrolls left, taking MR CREAK and his speech bubble out of view.</div>
<div>2) <a class="link" href="../asm/25248.html">25248</a> (update display) is called from the main loop; this calls <a class="link" href="../asm/26849.html">26849</a>, which sets <a class="link" href="../asm/32760.html">32760</a> to 0 (indicating that the bubble is no longer on-screen).</div>
<div>3) MR WITHIT begins execution of the entry point at <a class="link" href="../asm/27144.html#27165">27165</a>; this detects that <a class="link" href="../asm/32760.html">32760</a> is now 0, and so calls <a class="link" href="../asm/26958.html">26958</a> to open the speech bubble, which:</div>
<div>&#160; a) sets <a class="link" href="../asm/32760.html">32760</a> to some non-zero value (indicating that the bubble is on-screen), and</div>
<div>&#160; b) updates <a class="link" href="../asm/32762.html">32762</a> to the current leftmost column on-screen.</div>
<div>4) MR CREAK begins execution of the entry point at <a class="link" href="../asm/27144.html#27182">27182</a>; this first calls <a class="link" href="../asm/26849.html">26849</a>, which:</div>
<div>&#160; a) detects the non-zero value in <a class="link" href="../asm/32760.html">32760</a>, and</div>
<div>&#160; b) fails to detect that the screen has scrolled, because MR WITHIT updated <a class="link" href="../asm/32762.html">32762</a>,</div>
<div>thus fooling MR CREAK into thinking that his speech bubble is still on-screen.</div>
<div>5) MR CREAK and MR WITHIT share the speech bubble, taking turns rolling message characters into it until one of them finishes.</div>
</div>
</div>
<div><a name="pelletHover"></a></div>
<div class="box box-1">
<div class="box-title">Hovering pellet</div>
<div class="paragraph">
If a catapult pellet bounces off a teacher's head on the top floor, it never hits the ceiling; instead it hovers just below the ceiling briefly before disappearing (see <a class="link" href="../asm/30380.html#30459">30459</a>).
</div>
<div class="paragraph">
<div>POKE 30474,250</div>
<div>POKE 30475,207</div>
<div>POKE 30476,116</div>
</div>
</div>
<div><a name="pelletWall"></a></div>
<div class="box box-2">
<div class="box-title">Pellet through the wall</div>
<div class="paragraph">
If ERIC stands against the far wall of the Science Lab storeroom while facing it, and then fires his catapult, the pellet will travel through the wall. See the routine at <a class="link" href="../asm/28315.html">28315</a> (which lets ERIC reach x-coordinate 63 - rather too close to that far wall), and the routine at <a class="link" href="../asm/30292.html">30292</a> (which takes that far wall to be at x-coordinate 62).
</div>
<div class="paragraph">
<div>POKE 28375,62 (to stop ERIC at x-coordinate 62 instead of 63), or...</div>
<div>POKE 30348,63 (to check for the wall in front of the pellet at x-coordinate 63 instead of 62)</div>
</div>
</div>
<div><a name="pelletDoor"></a></div>
<div class="box box-1">
<div class="box-title">Pellet through the door</div>
<div class="paragraph">
If ERIC stands against the right study door while facing it, and then fires his catapult, the pellet will travel through the door. See the routine at <a class="link" href="../asm/30292.html">30292</a>, which checks for the presence of the right study door at x-coordinate 84 in front of the pellet. But when ERIC is standing up against the door, he is already at x-coordinate 84, which is where the pellet will be launched from; so at launch time, the x-coordinate of the spot in front of the pellet is 83, and the door check fails.
</div>
</div>
<div><a name="conkerMD"></a></div>
<div class="box box-2">
<div class="box-title">Conker of mass destruction</div>
<div class="paragraph">
The section of code at <a class="link" href="../asm/29896.html#29943">29943</a> was probably meant to check whether any of the four main kids besides ERIC has been hit by the falling conker. However, because the <span class="register">B</span> and <span class="register">D</span> registers are not properly initialised before calling the routine at <a class="link" href="../asm/27820.html">27820</a>, every character (including the non-human objects) is treated as a potential target.
</div>
<div class="paragraph">
One consequence of this bug is that it's possible to knock out the little boys with the conker. Not all that interesting, I suppose.
</div>
<div class="paragraph">
Another consequence of this bug is that it's possible to 'knock out' the bike. But, of course, there is no 'knocked out bike' sprite; instead, an airborne frog (specifically, animatory state <a class="link" href="../graphics/as.html#30">30</a> or <a class="link" href="../graphics/as.html#158">158</a>, depending on which way the bike is facing) is displayed. Which is rather more interesting. (And easy to verify, too, since the bike is not a moving target. Just park it at the base of the tree and get firing through the top-floor window.)
</div>
<div class="paragraph">
Unfortunately, owing to a technicality, the other non-human objects - mouse, frog, BOY WANDER's pellet etc. - are not vulnerable to the conker's destructive effects. (That technicality being that each is controlled by a routine whose address is stored in bytes 17 and 18 of the character buffer, so they are passed over by the routine at <a class="link" href="../asm/27820.html">27820</a>.) Oh well.
</div>
</div>
<div><a name="noBlackboardTales"></a></div>
<div class="box box-1">
<div class="box-title">No blackboard tales</div>
<div class="paragraph">
EINSTEIN never tells tales on ERIC or BOY WANDER for writing on the blackboard. This is because the section of code at <a class="link" href="../asm/61696.html#61852">61852</a> calls <a class="link" href="../asm/26453.html">26453</a> to collect the ID of the blackboard that the teacher is standing beside, but that routine returns early (with an invalid blackboard ID in <span class="register">B</span>) because the teacher is not standing within a threshold of 4 spaces of the left edge of the board. Instead, the routine at <a class="link" href="../asm/28658.html">28658</a> should be called, which collects the ID of the blackboard within a threshold of 12 spaces:
</div>
<div class="paragraph">
POKE 61853,242: POKE 61854,111
</div>
<div class="paragraph">
But this reveals another bug in the section of code at <a class="link" href="../asm/61696.html#61852">61852</a>: instead of placing the message number for the name of the character EINSTEIN is grassing up (<a class="link" href="../asm/61345.html">27</a> or <a class="link" href="../asm/61397.html">31</a>) into <a class="link" href="../asm/32656.html">32656</a>, it places the character number (206 or 210) there, which means EINSTEIN ends up saying either:
</div>
<div class="paragraph">
'Please Sir I cannot tell a lie . . 714 wrote on the board'
</div>
<div class="paragraph">
('714' being message <a class="link" href="../asm/64884.html">206</a>) or:
</div>
<div class="paragraph">
'Please Sir I cannot tell a lie . . X wrote on the board'
</div>
<div class="paragraph">
where 'X' is the textual representation of whatever happens to be at address 20289 (in the display file) at the time of grassing (20289 being equal to PEEK (210+<a class="link" href="../asm/65024.html">65024</a>) + 256 * PEEK (210+<a class="link" href="../asm/65280.html">65280</a>), which is how the address of message 210 would be determined if it existed).
</div>
</div>
<div><a name="doubleWipe"></a></div>
<div class="box box-2">
<div class="box-title">Double wipe</div>
<div class="paragraph">
If ERIC leaves class at some point after the teacher has started wiping the board, but returns while EINSTEIN is telling the teacher that he's absent, the teacher will give ERIC or EINSTEIN lines, and then start wiping the board again (see <a class="link" href="../asm/61696.html#61899">61899</a>), without first walking to the right edge of the board. This means that either:
</div>
<div class="paragraph">
<div>(a) the lesson will resume with the teacher standing near the doorway (if the class is in the Yellow Room or the Science Lab), or</div>
<div>(b) the teacher will walk through the far left wall of the boys' skool, conduct the rest of the lesson from behind the wall until the bell rings, and later reappear through the far right wall of the girls' skool (if the class is in the Blue Room).</div>
</div>
<div class="paragraph">
You can confirm (b) by making use of the <a class="link" href="bugs.html#farLeft">far left scroll bug</a> to scroll the screen left until the girls' skool is in view. Or you can follow the teacher through the 'no man's land' between the two skools by using the POKEs given <a class="link" href="pokes.html#throughWalls">here</a> (which enable ERIC to walk through walls).
</div>
</div>
<div><a name="tripleWipe"></a></div>
<div class="box box-1">
<div class="box-title">Triple wipe</div>
<div class="paragraph">
If you exploit the <a class="link" href="bugs.html#doubleWipe">double wipe bug</a> twice in one lesson - to make the teacher wipe the board for a third time - some of the play area graphics become corrupted. Specifically, the non-blackboard tiles at the following locations are wiped blank and show up as black squares:
</div>
<div class="paragraph">
<div>y=2: x=15, 18, 21, 34, 37, 43, 46, 49, 85</div>
<div>y=3: x=27, 85, 183</div>
<div>y=4: x=30, 183</div>
<div>y=5: x=12, 14, 16, 18, 20, 51, 53, 55, 57, 59, 132, 169, 171, 173, 175, 177, 183</div>
<div>y=6: x=40, 132 (at the level of the top floor)</div>
<div>y=7: x=132</div>
<div>y=8: x=14, 15, 132</div>
<div>y=9: x=15, 132</div>
<div>y=10: x=15, 132</div>
<div>y=11: x=6, 15</div>
<div>y=12: x=4, 15, 34, 132</div>
<div>y=13: x=6, 8, 10, 12 (at the level of the middle floor)</div>
<div>y=14: x=62, 102, 184, 185</div>
<div>y=15: x=62, 86</div>
<div>y=16: x=12, 14, 86</div>
<div>y=17: x=86</div>
<div>y=18: x=39, 86</div>
<div>y=19: x=21 (just above the level of the bottom floor)</div>
</div>
<div class="paragraph">
<table>
<tr>
<td><img alt="triple_wipe1" src="../images/play_area/triple_wipe1.png" /></td>
</tr>
<tr>
<td><img alt="triple_wipe2" src="../images/play_area/triple_wipe2.png" /></td>
</tr>
</table>
</div>
<div class="paragraph">
This happens because the board-wiping routine (<a class="link" href="../asm/26639.html">26639</a>) calls <a class="link" href="../asm/28658.html">28658</a> to collect information about the blackboard, which in turn calls <a class="link" href="../asm/26453.html">26453</a>. That routine returns early (with bogus blackboard coordinates in <span class="register">DE</span>) because the teacher is not standing at a blackboard, but <a class="link" href="../asm/26639.html">26639</a> carries on regardless, and the teacher ends up wiping a non-existent blackboard at the non-existent location (58,211), with the result that certain non-blackboard tiles end up getting wiped instead.
</div>
<div class="paragraph">
This bug can be hard to reproduce because the bell usually rings before you get a chance to make the teacher begin the third wipe; to improve your chances, try the <a class="link" href="pokes.html#lessonLength">lesson length POKEs</a> to extend the lesson.
</div>
</div>
<div><a name="deceptiveDoorways"></a></div>
<div class="box box-2">
<div class="box-title">Deceptive doorways</div>
<div class="paragraph">
It would be reasonable to assume that the doorway to a classroom in the boys' skool marks the boundary beyond which ERIC may be regarded as either absent from or present in that class (depending on which side of the boundary he stands). But it is not so.
</div>
<div class="paragraph">
For example, the Blue Room extends beyond its doorway, such that ERIC is regarded as present when he is standing anywhere up to and including x-coordinate 23 (even though he appears to be entirely outside the classroom at that location):
</div>
<div class="paragraph">
<table>
<tr>
<td><img alt="deceptive_doorways1" src="../images/play_area/deceptive_doorways1.png" /></td>
</tr>
</table>
</div>
<div class="paragraph">
So ERIC can stand here during a class in the Blue Room without EINSTEIN telling on him for being absent, or stand here during Revision Library and be told to GET ALONG NOW.
</div>
<div class="paragraph">
Similarly, the Yellow Room extends beyond its right-hand doorway, all the way up to and including x-coordinate 63:
</div>
<div class="paragraph">
<table>
<tr>
<td><img alt="deceptive_doorways2" src="../images/play_area/deceptive_doorways2.png" /></td>
</tr>
</table>
</div>
<div class="paragraph">
However, the Yellow Room has its left boundary at x-coordinate 41, so if ERIC stands at x-coordinate 40, he is regarded as absent (even though he appears to be entirely inside the classroom):
</div>
<div class="paragraph">
<table>
<tr>
<td><img alt="deceptive_doorways3" src="../images/play_area/deceptive_doorways3.png" /></td>
</tr>
</table>
</div>
<div class="paragraph">
(Try standing here while waiting for the lesson in the Yellow Room to begin; EINSTEIN will tell the teacher that ERIC is absent, and the teacher will go looking for him.)
</div>
<div class="paragraph">
Likewise, the left boundary of the Science Lab is at x-coordinate 31, a little to the right of its doorway. Which means that if ERIC stands at x-coordinate 30, he is regarded as absent (again, even though he appears to be entirely inside the classroom):
</div>
<div class="paragraph">
<table>
<tr>
<td><img alt="deceptive_doorways4" src="../images/play_area/deceptive_doorways4.png" /></td>
</tr>
</table>
</div>
<div class="paragraph">
To adjust the real boundaries of the classrooms so that they are more closely aligned with the apparent boundaries, see the location identifier tables at <a class="link" href="../asm/47676.html">47676</a> (top floor) and <a class="link" href="../asm/47932.html">47932</a> (middle floor).
</div>
</div>
<div><a name="speechQueue"></a></div>
<div class="box box-1">
<div class="box-title">Speech queue hogs</div>
<div class="paragraph">
ERIC's teacher and EINSTEIN can hog the 'speech queue' for several rounds of a question-and-answer session, making the other teachers wait a long time - sometimes until after the bell has rung - before they can tell the kids to sit down or what to do during the lesson.
</div>
<div class="paragraph">
The reason this can happen is that there actually is no speech queue. That is, there is no mechanism for recording whose 'turn' it is to speak next.
</div>
<div class="paragraph">
Consider the case where ERIC is being taught by MR CREAK in the Yellow Room, and MR ROCKITT is teaching in the Science Lab:
</div>
<div class="paragraph">
<ul>
<li>MR CREAK is asking a question</li>
<li>EINSTEIN is waiting for MR CREAK to finish speaking</li>
<li>MR ROCKITT is standing at the blackboard, waiting to tell the kids what to do</li>
</ul>
</div>
<div class="paragraph">
When MR CREAK finishes speaking, the character-moving routine at <a class="link" href="../asm/25296.html">25296</a> considers moving the following characters (after MR CREAK) in this order:
</div>
<div class="paragraph">
<ul>
<li>MISS TAKE</li>
<li>ALBERT</li>
<li>BOY WANDER</li>
<li>ANGELFACE</li>
<li>EINSTEIN</li>
</ul>
</div>
<div class="paragraph">
A character will be moved if bit 7 of byte 29 of his buffer is set (which is true for kids half the time on average, and true for teachers only when they're running), or if byte 30 of his buffer (which is decremented on each pass through the character-moving routine) holds an even number. If either of these is true for EINSTEIN, he will get to speak next. When he's finished answering MR CREAK's question, the character-moving routine considers moving the following characters (after EINSTEIN) in this order:
</div>
<div class="paragraph">
<ul>
<li>HAYLEY</li>
<li>little girls</li>
<li>little boys</li>
<li>MR WACKER</li>
<li>MR WITHIT</li>
<li>MR ROCKITT</li>
<li>MR CREAK</li>
</ul>
</div>
<div class="paragraph">
If, on MR ROCKITT's turn, byte 30 of his buffer holds an odd number, he will not be moved, and will therefore not start speaking before MR CREAK. If, on MR CREAK's turn, byte 30 of his buffer holds an even number, he will be moved and therefore start speaking before MR ROCKITT's next turn.
</div>
<div class="paragraph">
Thus MR ROCKITT could spend quite a while waiting at the blackboard before telling the kids what to do, all depending on the contents of byte 30 of his, MR CREAK's and EINSTEIN's buffers (and also bit 7 of byte 29 of EINSTEIN's buffer) on their turns to be moved.
</div>
</div>
<div><a name="jumpAbsent"></a></div>
<div class="box box-2">
<div class="box-title">Jump out of class</div>
<div class="paragraph">
If ERIC jumps continuously (hold 'J' down) during class, EINSTEIN will tell the teacher that ERIC is absent.
</div>
<div class="paragraph">
This is a consequence of the zero flag being set upon entry to the routine at <a class="link" href="../asm/28085.html">28085</a>, which forces an early return with <span class="register">D</span>=17, indicating that ERIC is on the bottom floor (even though he isn't). In this case, the zero flag is set by the 'CP 52' instruction at <a class="link" href="../asm/61512.html#61515">61515</a>.
</div>
<div class="paragraph">
POKE 28086,254
</div>
</div>
<div><a name="jumpDinner"></a></div>
<div class="box box-1">
<div class="box-title">Jump into the dinner hall</div>
<div class="paragraph">
During dinner, go to the Yellow Room or the Science Lab, directly above the dinner hall. When the teacher on dinner duty comes and finds ERIC there, jump (press 'J'). The teacher will then return to the dinner hall, tricked into thinking that ERIC is back there too.
</div>
<div class="paragraph">
This is another consequence of the zero flag being set upon entry to the routine at <a class="link" href="../asm/28085.html">28085</a>, which forces an early return with <span class="register">D</span>=17, indicating that ERIC is on the bottom floor (even though he isn't). In this case, the zero flag is set by the 'BIT 0,(HL)' instruction at <a class="link" href="../asm/61595.html#61608">61608</a>.
</div>
<div class="paragraph">
POKE 28086,254
</div>
</div>
<div><a name="jumpAssembly"></a></div>
<div class="box box-2">
<div class="box-title">Jump into the assembly hall</div>
<div class="paragraph">
During assembly, go to the area between the Yellow Room and the head's study. When MR WITHIT comes and finds ERIC there, jump (press 'J'). MR WITHIT will then return to the assembly hall, tricked into thinking that ERIC is back there too.
</div>
<div class="paragraph">
This is yet another consequence of the zero flag being set upon entry to the routine at <a class="link" href="../asm/28085.html">28085</a>, which forces an early return with <span class="register">D</span>=17, indicating that ERIC is on the bottom floor (even though he isn't). In this case, the zero flag is set by the 'BIT 0,(HL)' instruction at <a class="link" href="../asm/61595.html#61608">61608</a>.
</div>
<div class="paragraph">
POKE 28086,254
</div>
</div>
<div><a name="jump4Spaces"></a></div>
<div class="box box-1">
<div class="box-title">One more jump bug</div>
<div class="paragraph">
Play truant during class, somewhere on the top or middle floor. (The toilets are an ideal spot.) As ERIC's teacher approaches, start jumping continuously (hold 'J' down). When the teacher reaches the spot four spaces away from ERIC, you might see him turn round briefly, and then turn round again to continue the approach towards ERIC. The reason the teacher turns round is that he is tricked into thinking that ERIC is on the bottom floor, and so starts heading for the nearest staircase.
</div>
<div class="paragraph">
This is one more (less dramatic) consequence of the zero flag being set upon entry to the routine at <a class="link" href="../asm/28085.html">28085</a>, which forces an early return with <span class="register">D</span>=17, indicating that ERIC is on the bottom floor (even though he isn't). In this case, the zero flag is set by the 'CP 4' instruction at <a class="link" href="../asm/25944.html#25986">25986</a>.
</div>
<div class="paragraph">
POKE 28086,254
</div>
</div>
<div class="footer">
<div class="release">The complete Back to Skool RAM disassembly 20140614</div>
<div class="copyright">&#169; 1985 Microsphere Computer Services Ltd (Back to Skool). &#169; 2014 Richard Dymond (this disassembly).</div>
<div class="created">Created using <a class="link" href="http://pyskool.ca/?page_id=177">SkoolKit</a> 4.0.</div>
</div>
</body>
</html>