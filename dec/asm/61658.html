<!DOCTYPE html>
<html>
<head>
<title>Back to Skool: Routine at 61658</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Back to Skool" src="../../images/logo-dec.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="61657.html">61657</a>
</td>
<td class="up">Up: <a href="../maps/all.html#61658">Map</a></td>
<td class="next">
Next: <a href="61693.html">61693</a>
</td>
</tr>
</table>
<div class="description">61658: Control a teacher during assembly</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by command list <a href="59788.html">80</a>. Makes the teacher stand still until the period is nearly over, and also perform assembly duty (if the teacher is MR WITHIT).
</div>
</div>
<table class="input">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">H</td>
<td class="register-desc">Teacher's character number (201-203)</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="address-2"><span id="61658"></span>61658</td>
<td class="instruction">LD A,(32740)</td>
<td class="comment-1" rowspan="1">Collect the MSB of the lesson clock (which starts off at 16)</td>
</tr>
<tr>
<td class="address-1"><span id="61661"></span>61661</td>
<td class="instruction">CP 2</td>
<td class="comment-1" rowspan="1">Has the teacher been standing still long enough (the routine at <a href="62032.html">62032</a> sets the MSB of the lesson clock to 1 after MR WACKER has finished his detention speech)?</td>
</tr>
<tr>
<td class="address-1"><span id="61663"></span>61663</td>
<td class="instruction">JP C,<a href="25484.html">25484</a></td>
<td class="comment-1" rowspan="1">Move to the next command in the command list if so</td>
</tr>
<tr>
<td class="address-1"><span id="61666"></span>61666</td>
<td class="instruction">CP 11</td>
<td class="comment-1" rowspan="1">Is it time for the kids to sit down for assembly yet?</td>
</tr>
<tr>
<td class="address-1"><span id="61668"></span>61668</td>
<td class="instruction">RET NC</td>
<td class="comment-1" rowspan="1">Return if not</td>
</tr>
<tr>
<td class="address-1"><span id="61669"></span>61669</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=teacher's character number</td>
</tr>
<tr>
<td class="address-1"><span id="61670"></span>61670</td>
<td class="instruction">CP 201</td>
<td class="comment-1" rowspan="1">Is this MR WITHIT (who does assembly duty)?</td>
</tr>
<tr>
<td class="address-1"><span id="61672"></span>61672</td>
<td class="instruction">RET NZ</td>
<td class="comment-1" rowspan="1">Return if not</td>
</tr>
<tr>
<td class="address-1"><span id="61673"></span>61673</td>
<td class="instruction">LD DE,32640</td>
<td class="comment-1" rowspan="4">Set bits 6 (ERIC should be here now) and 7 (time to sit down: this is checked by command lists <a href="57942.html">20</a>, <a href="59151.html">40</a> and <a href="58862.html">88</a>) at <a href="32640.html">32640</a></td>
</tr>
<tr>
<td class="address-1"><span id="61676"></span>61676</td>
<td class="instruction">LD A,(DE)</td>
</tr>
<tr>
<td class="address-1"><span id="61677"></span>61677</td>
<td class="instruction">OR 192</td>
</tr>
<tr>
<td class="address-1"><span id="61679"></span>61679</td>
<td class="instruction">LD (DE),A</td>
</tr>
<tr>
<td class="address-1"><span id="61680"></span>61680</td>
<td class="instruction">LD A,(32740)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=MSB of the lesson clock</td>
</tr>
<tr>
<td class="address-1"><span id="61683"></span>61683</td>
<td class="instruction">CP 10</td>
<td class="comment-1" rowspan="1">Is it time to find ERIC if he's absent?</td>
</tr>
<tr>
<td class="address-1"><span id="61685"></span>61685</td>
<td class="instruction">RET NC</td>
<td class="comment-1" rowspan="1">Return if not</td>
</tr>
<tr>
<td class="address-1"><span id="61686"></span>61686</td>
<td class="instruction">CALL <a href="32021.html">32021</a></td>
<td class="comment-1" rowspan="1">Is ERIC in the assembly hall?</td>
</tr>
<tr>
<td class="address-1"><span id="61689"></span>61689</td>
<td class="instruction">RET Z</td>
<td class="comment-1" rowspan="1">Return if so</td>
</tr>
<tr>
<td class="address-1"><span id="61690"></span>61690</td>
<td class="instruction">JP <a href="61631.html#61648">61648</a></td>
<td class="comment-1" rowspan="1">Go and find him otherwise</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="61657.html">61657</a>
</td>
<td class="up">Up: <a href="../maps/all.html#61658">Map</a></td>
<td class="next">
Next: <a href="61693.html">61693</a>
</td>
</tr>
</table>
<footer>
<div class="release">The complete Back to Skool RAM disassembly 20200811</div>
<div class="copyright">&#169; 1985 Microsphere Computer Services Ltd. &#169; 2020 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.2.</div>
<div><a href="../../asm/F0DA.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>